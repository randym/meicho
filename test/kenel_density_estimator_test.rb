require 'test_helper'

class KernelDensityEstimatorTest < Minitest::Test
  def arr
    @arr ||= [1, 3, 1, 2, 1]
  end

  def test_pdf # rubocop:disable Metrics/MethodLength
    expected = [
      [0.9, 0.48665747258218284],
      [1.0, 0.5037156144958304],
      [1.1, 0.5039975010619311],
      [1.2000000000000002, 0.48894204450850487],
      [1.3, 0.4617968562483662],
      [1.4, 0.4269000436760649],
      [1.5, 0.3887894885678811],
      [1.6, 0.351382239572934],
      [1.7000000000000002, 0.31742912096187653],
      [1.8, 0.28834809097846725],
      [1.9, 0.26441328723155794],
      [2.0, 0.24517078151890154],
      [2.1, 0.22990148381332212],
      [2.2, 0.21796806472745875],
      [2.3000000000000003, 0.20895287496243622],
      [2.4, 0.2025867095429852],
      [2.5, 0.19854834503297625],
      [2.6, 0.19625501402382467],
      [2.7, 0.19475445679971315],
      [2.8000000000000003, 0.19277881777148562],
      [2.9, 0.18895207291379765],
      [3.0, 0.1820827821591916],
      [3.1, 0.17144379089278872]
    ]
    assert_equal expected, Meicho::KernelDensityEstimator.new(arr).pdf
  end

  def test_pdf_with_step
    stepped = [
      [0.5, 0.2920079661273289],
      [1.0, 0.5037156144958304],
      [1.5, 0.3887894885678811],
      [2.0, 0.24517078151890154],
      [2.5, 0.19854834503297625],
      [3.0, 0.1820827821591916],
      [3.5, 0.09844492124622435]
    ]
    assert_equal stepped, Meicho::KernelDensityEstimator.new(arr, 0.5).pdf
  end
end
