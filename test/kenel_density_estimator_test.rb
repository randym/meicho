require 'test_helper'

class KernelDensityEstimatorTest < Minitest::Test
  def arr
    @arr ||= [1, 3, 1, 2, 1]
  end

  def test_pdf
    expected = [
      [0.9, 0.4217425118333514],
      [1.0, 0.4359985405470501],
      [1.1, 0.4407317870556215],
      [1.2000000000000002, 0.43636187427297757],
      [1.3, 0.42403619990828945],
      [1.4, 0.40544061820755356],
      [1.5, 0.3825509094511777],
      [1.6, 0.3573743268887135],
      [1.7000000000000002, 0.3317272307358827],
      [1.8, 0.3070807707827615],
      [1.9, 0.2844865678238208],
      [2.0, 0.2645745881205178],
      [2.1, 0.24760145308211287],
      [2.2, 0.23352242078845284],
      [2.3000000000000003, 0.22206415474400434],
      [2.4, 0.21278524723218978],
      [2.5, 0.20512282533189594],
      [2.6, 0.19843211988963458],
      [2.7, 0.19202892321410703],
      [2.8000000000000003, 0.18524206823634906],
      [2.9, 0.17747629991291758],
      [3.0, 0.16827832656717218],
      [3.1, 0.15739358898781525]
    ]
    assert_equal expected, Meicho::KernelDensityEstimator.new(arr).pdf
  end

  def test_pdf_with_step
    stepped = [[0.5, 0.2883170481216389], [1.0, 0.4359985405470501], [1.5, 0.3825509094511777],
               [2.0, 0.2645745881205178], [2.5, 0.20512282533189594], [3.0, 0.16827832656717218], 
               [3.5, 0.09984932546256127]]
    assert_equal stepped, Meicho::KernelDensityEstimator.new(arr, 0.5).pdf
  end
end
